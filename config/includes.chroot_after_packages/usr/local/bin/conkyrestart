#!/bin/bash
#
# Change running conkys to use transparency settings on the fly if
# there is a second rc ending in -trans.conf.
# Made by sleekmason 23.10.30
#
# Path to newly created file
conkyfile=/tmp/conkyswitcher
# Copy currently running conkys to file -
ps aux | grep -i conky | awk '{ print $13 }' | tail > $conkyfile
# Adjust file for correct lines
sed -i "/^Conky\b/d" $conkyfile
sed -i "/^conky\b/d" $conkyfile
sed -i '/^[[:space:]]*$/d' $conkyfile
sed -i -e 's/^/conky -c /' $conkyfile
sed -i '1i #!/bin/bash' $conkyfile
# Remove -trans from all to start -
sed -i 's/-trans//g' $conkyfile
# Add condition -
if pgrep -x picom > /dev/null 2>&1; then
sed -i 's/\(.*\).conf/\1-trans.conf/' $conkyfile
fi
# Restart -
killall conky
chmod +x $conkyfile
sleep .30
$conkyfile
# Remove file if desired
# rm -f $conkyfile
